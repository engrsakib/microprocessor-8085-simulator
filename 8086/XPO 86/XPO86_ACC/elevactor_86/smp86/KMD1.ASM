kX



	PAGE,80
	TITLE-- ADC
;
ADC	SEGMENT
	ASSUME CS:ADC, DS:ADC ,ES:ADC 
	ORG 100H		;COM FORMAT IS RECOMMENDED.
STRT:	JMP SKIP_DATA			;SKIP LOOK UP/ DATA BASES IF ANY
;ON KIT YOU NEED TO DO INIT FOR SP [TO SEPARATE STACK OF YOUR PROGRAME FROM
;MONITORS],DS AS SHOWN BELOW.SS,ES ARE SET TO 0000 AT POWER ON BY MONITOR.
;YOU CAN OFCOURSE CHANGE IT BY ADDING A FEW MORE MOVE`S.
;BUT WHILE WORKING ON PC YOU CAN`T TOUCH SEGMENT REGISTERS SINCE THEY ARE
;SET BY DOS LOADER,SO MANAGE THESE INSTRUCTIONS AS SHOWN IN COMMENT FIELD.  
SKIP_DATA:MOV AX,11FFH			;INIT OF SP FOR KIT
	MOV SP,AX			;MOV AX,AX   ON PC
	PUSH CS				;THIS IS THE BEST WAY TO LOAD DS
	POP DS				;WITH SEGMENT VALUE.
	NOP				;LOAD KIT INT S (A0-BF) IN PC USING
	NOP				;CALL LDINPC
	NOP			;PLACE ABOVE CALL IN PLACE OF 3 NOP`S
	INT 0ACH			;CLEAR DISPLAY	
	MOV AH,92H		;INIT 8255L -PORT A,B INPUT.C-OUTPUT.
	MOV DX,8806H	
	OUT DX,AX
LUP01:	MOV DX,8804H		;PORT C=1*010000 SET FOR DIFFERENTIAL,
	MOV AH,90H		;SAMPLE MODE FOR S/H,RUN MODE FOR ADC
	OUT DX,AX		;CHANNEL INFO IS RELEVANT IF YOU CONNECT
				;INSTRU OP AMP MODULE TO ADC
	MOV DX,8802H
LUP02:	IN AX,DX		;CHECK STATUS LINE
	AND AH,40H		;CONVERSION REALY BEGUN?
	JZ LUP02
LUP03:	IN AX,DX		;NOW CONVERSION REALLY STARTS.
	AND AH,40H		;CONVERSION OVER?
	JNZ LUP03
	MOV DX,8804H
	IN AX,DX		;SET CS LOW AND PUT ADC
	AND AH,7FH		;IN HOLD MODE.
	OUT DX,AX
	MOV DX,8800H
	IN AX,DX		;READ LOWER BYTE
	MOV CL,AH
	MOV DX,8802H		;
	IN AX,DX		;READ UPPER BYTE
	AND AH,3FH		;SUPRESS STATUS AND DON`T CARE,
	MOV CH,AH		;SAVE IT
	AND AH,10H		;CHECK OVER-RANGE?
	JNZ SKP1
	INT 0ABH			;CALL CRET-ONLY LINE FEED
	MOV AH,CH
	AND AH,20H		;POLARITY?
	JZ SKP2Š	MOV AL,"+"		;POSITIVE POLARITY
	INT 0BAH			;WRITE AT PRESENT CURSOR POS.
	JMP SKP3
SKP2:	MOV AL,"-"		; NEGATIVE POL.
	INT 0BAH			;DISPLAY
SKP3:	MOV AL,03H		;NO. OF DIGITS
	MOV DX,CX		;RT.HAND JUSTIFIED NO.
	INT 0AEH			;CALL NMOUT	
LUP04:	MOV AH,0BH	
	INT 0A1H			;CHECK KBD STATUS ?
	CMP AL,00H
	JZ LUP01		;NO KEY--LOOP BACK
	INT 0A3H			;RETURN TO COMMAND MODE
SKP1:	INT 0ABH			;ONLY CR
	MOV AL,"O"		;OR FOR OVERRANGE
	




	MOV AL," "
	INT 0BAH			;TO BLANK NEXT TWO CHARACTERS
	INT 0BAH
	JMP LUP04
;IF YOU ARE RUNNING YOUR SOFTWARE ON PC INSERT HERE -->INCLUDE KIT_INTS.ASM
ADC	ENDS			;READ FOR MORE INFO TITLE OF KIT_INTS.ASM
	END STRT
                                                                              
kX

























Š




%%%%	 		 